From df4bae62a2c1c5a4b92f59bb6873bcb21325c62e Mon Sep 17 00:00:00 2001
From: florent Richard <florent.r08@live.fr>
Date: Fri, 16 Apr 2021 17:07:09 +0200
Subject: [PATCH] =?UTF-8?q?Ajout=20de=20la=20fonctionnalit=C3=A9=20pour=20?=
 =?UTF-8?q?ajouter=20un=20personnel?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 MediaTek86/MediaTek86.csproj              |   5 +-
 MediaTek86/Program.cs                     |   4 +-
 MediaTek86/controle/Controle.cs           |  58 ++++++++++
 MediaTek86/dal/AccesDonnees.cs            |  63 ++++++++++-
 MediaTek86/modele/Absence.cs              |   7 +-
 MediaTek86/modele/Motif.cs                |   5 +-
 MediaTek86/modele/Personnel.cs            |  18 +++-
 MediaTek86/modele/Responsable.cs          |   5 +-
 MediaTek86/modele/Service.cs              |  33 +++---
 MediaTek86/vue/ListePersonnel.Designer.cs |  93 +++++++++++-----
 MediaTek86/vue/ListePersonnel.cs          | 126 +++++++++++++++++++++-
 MediaTek86/vue/SeConnecter.cs             |   2 +-
 12 files changed, 354 insertions(+), 65 deletions(-)
 create mode 100644 MediaTek86/controle/Controle.cs

diff --git a/MediaTek86/MediaTek86.csproj b/MediaTek86/MediaTek86.csproj
index ee5afd9..946648f 100644
--- a/MediaTek86/MediaTek86.csproj
+++ b/MediaTek86/MediaTek86.csproj
@@ -93,6 +93,7 @@
   </ItemGroup>
   <ItemGroup>
     <Compile Include="connexion\ConnexionBDD.cs" />
+    <Compile Include="controle\Controle.cs" />
     <Compile Include="dal\AccesDonnees.cs" />
     <Compile Include="modele\Absence.cs" />
     <Compile Include="modele\Motif.cs" />
@@ -170,8 +171,6 @@
   <ItemGroup>
     <None Include="App.config" />
   </ItemGroup>
-  <ItemGroup>
-    <Folder Include="controle\" />
-  </ItemGroup>
+  <ItemGroup />
   <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
 </Project>
\ No newline at end of file
diff --git a/MediaTek86/Program.cs b/MediaTek86/Program.cs
index d41d00b..8e6602e 100644
--- a/MediaTek86/Program.cs
+++ b/MediaTek86/Program.cs
@@ -1,4 +1,4 @@
-﻿using MediaTek86.vue;
+﻿using MediaTek86.controle;
 using System;
 using System.Collections.Generic;
 using System.Linq;
@@ -17,7 +17,7 @@ namespace MediaTek86
         {
             Application.EnableVisualStyles();
             Application.SetCompatibleTextRenderingDefault(false);
-            Application.Run(new frmSeConnecter());
+            new Controle();
         }
     }
 }
diff --git a/MediaTek86/controle/Controle.cs b/MediaTek86/controle/Controle.cs
new file mode 100644
index 0000000..0660903
--- /dev/null
+++ b/MediaTek86/controle/Controle.cs
@@ -0,0 +1,58 @@
+﻿using MediaTek86.dal;
+using MediaTek86.modele;
+using MediaTek86.vue;
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Threading.Tasks;
+
+namespace MediaTek86.controle
+{
+    /// <summary>
+    /// Gère les interractions entre la vue et le modèle
+    /// </summary>
+    public class Controle
+    {
+        /// <summary>
+        /// fenêtre d'authentification
+        /// </summary>
+        private frmListePersonnel frmListePersonnel;
+
+        /// <summary>
+        /// Ouverture de la fenêtre
+        /// </summary>
+        public Controle()
+        {
+            frmListePersonnel = new frmListePersonnel(this);
+            frmListePersonnel.ShowDialog();
+        }
+
+        /// <summary>
+        /// Récupère et retourne les infos du personnel provenant de la BDD
+        /// </summary>
+        /// <returns>liste du personnel</returns>
+        public List<Personnel> GetLesPersonnels()
+        {
+            return AccesDonnees.GetLesPersonnels();
+        }
+
+        /// <summary>
+        /// Récupère et retourne les infos des services provenant de la BDD
+        /// </summary>
+        /// <returns>liste des services</returns>
+        public List<Service> GetLesServices()
+        {
+            return AccesDonnees.GetLesServices();
+        }
+
+        /// <summary>
+        /// Demande d'ajout d'un personnel
+        /// </summary>
+        /// <param name="personnel"></param>
+        public void AddDeveloppeur(Personnel personnel)
+        {
+            AccesDonnees.AddPersonnel(personnel);
+        }
+    }
+}
diff --git a/MediaTek86/dal/AccesDonnees.cs b/MediaTek86/dal/AccesDonnees.cs
index b22971c..337c386 100644
--- a/MediaTek86/dal/AccesDonnees.cs
+++ b/MediaTek86/dal/AccesDonnees.cs
@@ -1,4 +1,5 @@
 ﻿using MediaTek86.connexion;
+using MediaTek86.modele;
 using System;
 using System.Collections.Generic;
 using System.Linq;
@@ -7,12 +8,72 @@ using System.Threading.Tasks;
 
 namespace MediaTek86.dal
 {
+
     public class AccesDonnees
     {
         /// <summary>
         /// chaine de connexion à la bdd
-        /// </summary>
+        /// /// </summary>
         private static string connectionString = "server=localhost;user id=admin;password=wHIwAcI3DijYBRvO;database=mediatek86;SslMode=none";
 
+        /// <summary>
+        /// Récupère et retourne le personnel provenant de la BDD
+        /// </summary>
+        /// <returns>liste du personnel</returns>
+        public static List<Personnel> GetLesPersonnels()
+        {
+            List<Personnel> lesPersonnels = new List<Personnel>();
+            string req = "select idpersonnel, p.nom as nom, prenom, tel, mail, s.idservice as idservice, s.nom as service ";
+            req += "from personnel p JOIN service s ON p.idservice = s.idservice ";
+            req += "order by nom";
+            ConnexionBDD curs = ConnexionBDD.GetInstance(connectionString);
+            curs.ReqSelect(req, null);
+            while (curs.Read())
+            {
+                Personnel personnel = new Personnel((int)curs.Field("idpersonnel"), (string)curs.Field("nom"), (string)curs.Field("prenom"), (string)curs.Field("tel"), (string)curs.Field("mail"), (int)curs.Field("idservice"), (string)curs.Field("service"));
+                lesPersonnels.Add(personnel);
+            }
+            curs.Close();
+            return lesPersonnels;
+        }
+
+        /// <summary>
+        /// Récupère et retourne les services provenant de la BDD
+        /// </summary>
+        /// <returns>liste des services</returns>
+        public static List<Service> GetLesServices()
+        {
+            List<Service> lesServices = new List<Service>();
+            string req = "select * from service order by nom";
+            ConnexionBDD curs = ConnexionBDD.GetInstance(connectionString);
+            curs.ReqSelect(req, null);
+            while (curs.Read())
+            {
+                Service service = new Service((int)curs.Field("idservice"), (string)curs.Field("nom"));
+                lesServices.Add(service);
+            }
+            curs.Close();
+            return lesServices;
+        }
+
+        /// <summary>
+        /// Ajoute un personnel
+        /// </summary>
+        /// <param name="personnel"></param>
+        public static void AddPersonnel(Personnel personnel)
+        {
+            string req = "insert into personnel(nom, prenom, tel, mail, idservice) ";
+            req += "values (@nom, @prenom, @tel, @mail, @idservice);";
+            Dictionary<string, object> parameters = new Dictionary<string, object>();
+            parameters.Add("@nom", personnel.Nom);
+            parameters.Add("@prenom", personnel.Prenom);
+            parameters.Add("@tel", personnel.Tel);
+            parameters.Add("@mail", personnel.Mail);
+            parameters.Add("@idservice", personnel.Idservice);
+            ConnexionBDD conn = ConnexionBDD.GetInstance(connectionString);
+            conn.ReqUpdate(req, parameters);
+        }
+
     }
+
 }
diff --git a/MediaTek86/modele/Absence.cs b/MediaTek86/modele/Absence.cs
index 0da536e..7541e12 100644
--- a/MediaTek86/modele/Absence.cs
+++ b/MediaTek86/modele/Absence.cs
@@ -5,8 +5,11 @@ using System.Text;
 using System.Threading.Tasks;
 
 namespace MediaTek86.modele
-{
-    class Absence
+{   
+    /// <summary>
+    /// Création d'une absence
+    /// </summary>
+    public class Absence
     {
         // Déclaration des propriétés
         private int idpersonnel;
diff --git a/MediaTek86/modele/Motif.cs b/MediaTek86/modele/Motif.cs
index 0762da8..c3d33d1 100644
--- a/MediaTek86/modele/Motif.cs
+++ b/MediaTek86/modele/Motif.cs
@@ -6,7 +6,10 @@ using System.Threading.Tasks;
 
 namespace MediaTek86.modele
 {
-    class Motif
+    /// <summary>
+    /// Création d'un motif
+    /// </summary>
+    public class Motif
     {
         // Déclaration des propriétés
         private int idmotif;
diff --git a/MediaTek86/modele/Personnel.cs b/MediaTek86/modele/Personnel.cs
index 502df60..7075847 100644
--- a/MediaTek86/modele/Personnel.cs
+++ b/MediaTek86/modele/Personnel.cs
@@ -6,15 +6,26 @@ using System.Threading.Tasks;
 
 namespace MediaTek86.modele
 {
-    class Personnel
+    /// <summary>
+    /// Création d'un personnel
+    /// </summary>
+    public class Personnel
     {
-        // Déclaration des propriétés
         private int idpersonnel;
         private string nom;
         private string prenom;
         private string tel;
         private string mail;
         private int idservice;
+        private string service;
+
+        public int Idpersonnel { get => idpersonnel; }
+        public string Nom { get => nom; }
+        public string Prenom { get => prenom; }
+        public string Tel { get => tel; }
+        public string Mail { get => mail; }
+        public int Idservice { get => idservice; }
+        public string Service { get => service; }
 
         /// <summary>
         /// Constructeur : valorise les propriétés
@@ -25,7 +36,7 @@ namespace MediaTek86.modele
         /// <param name="tel"></param>
         /// <param name="mail"></param>
         /// <param name="idservice"></param>
-        public Personnel(int idpersonnel, string nom, string prenom, string tel, string mail, int idservice)
+        public Personnel(int idpersonnel, string nom, string prenom, string tel, string mail, int idservice, string service)
         {
             this.idpersonnel = idpersonnel;
             this.nom = nom;
@@ -33,6 +44,7 @@ namespace MediaTek86.modele
             this.tel = tel;
             this.mail = mail;
             this.idservice = idservice;
+            this.service = service;
         }
     }
 }
diff --git a/MediaTek86/modele/Responsable.cs b/MediaTek86/modele/Responsable.cs
index 250573c..41f90c8 100644
--- a/MediaTek86/modele/Responsable.cs
+++ b/MediaTek86/modele/Responsable.cs
@@ -6,7 +6,10 @@ using System.Threading.Tasks;
 
 namespace MediaTek86.modele
 {
-    class Responsable
+    /// <summary>
+    /// Création d'un responsable
+    /// </summary>
+    public class Responsable
     {
         // Déclaration des propriétés
         private string login;
diff --git a/MediaTek86/modele/Service.cs b/MediaTek86/modele/Service.cs
index 580b261..ae94d28 100644
--- a/MediaTek86/modele/Service.cs
+++ b/MediaTek86/modele/Service.cs
@@ -6,40 +6,33 @@ using System.Threading.Tasks;
 
 namespace MediaTek86.modele
 {
-    class Service
+    public class Service
     {
-        // Déclaration des propriétés
         private int idservice;
         private string nom;
 
-        /// <summary>
-        /// Retourne idService
-        /// </summary>
-        /// <returns></returns>
-        public int GetIdService()
-        {
-            return idservice;
-        }
-
-        /// <summary>
-        /// Retourne le nom
-        /// </summary>
-        /// <returns></returns>
-        public string GetNom()
-        {
-            return nom;
-        }
+        public int Idservice { get => idservice; }
+        public string Nom { get => nom; }
 
         /// <summary>
         /// Constructeur : valorise les propriétés
         /// </summary>
         /// <param name="idservice"></param>
         /// <param name="nom"></param>
-        public Service(int idservice, string nom )
+        public Service(int idservice, string nom)
         {
             this.idservice = idservice;
             this.nom = nom;
         }
 
+        /// <summary>
+        /// Définit l'information à afficher (juste le nom)
+        /// </summary>
+        /// <returns>nom du profil</returns>
+        public override string ToString()
+        {
+            return this.nom;
+        }
+
     }
 }
diff --git a/MediaTek86/vue/ListePersonnel.Designer.cs b/MediaTek86/vue/ListePersonnel.Designer.cs
index 59349e5..1d5ecd5 100644
--- a/MediaTek86/vue/ListePersonnel.Designer.cs
+++ b/MediaTek86/vue/ListePersonnel.Designer.cs
@@ -28,7 +28,7 @@
         /// </summary>
         private void InitializeComponent()
         {
-            this.lstListePersonnel = new System.Windows.Forms.ListBox();
+            System.Windows.Forms.DataGridViewCellStyle dataGridViewCellStyle1 = new System.Windows.Forms.DataGridViewCellStyle();
             this.btnSupPersonnel = new System.Windows.Forms.Button();
             this.btnModifPersonnel = new System.Windows.Forms.Button();
             this.btnGererAbsence = new System.Windows.Forms.Button();
@@ -43,16 +43,12 @@
             this.lblService = new System.Windows.Forms.Label();
             this.cbbService = new System.Windows.Forms.ComboBox();
             this.btnAjouterPersonnel = new System.Windows.Forms.Button();
+            this.dgvPersonnel = new System.Windows.Forms.DataGridView();
+            this.btnEnregistrerPersonnel = new System.Windows.Forms.Button();
+            this.btnAnnulerAjout = new System.Windows.Forms.Button();
+            ((System.ComponentModel.ISupportInitialize)(this.dgvPersonnel)).BeginInit();
             this.SuspendLayout();
             // 
-            // lstListePersonnel
-            // 
-            this.lstListePersonnel.FormattingEnabled = true;
-            this.lstListePersonnel.Location = new System.Drawing.Point(25, 11);
-            this.lstListePersonnel.Name = "lstListePersonnel";
-            this.lstListePersonnel.Size = new System.Drawing.Size(707, 277);
-            this.lstListePersonnel.TabIndex = 0;
-            // 
             // btnSupPersonnel
             // 
             this.btnSupPersonnel.Location = new System.Drawing.Point(25, 298);
@@ -84,7 +80,7 @@
             // 
             this.lblNom.AutoSize = true;
             this.lblNom.Font = new System.Drawing.Font("Tahoma", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
-            this.lblNom.Location = new System.Drawing.Point(21, 342);
+            this.lblNom.Location = new System.Drawing.Point(22, 361);
             this.lblNom.Name = "lblNom";
             this.lblNom.Size = new System.Drawing.Size(54, 19);
             this.lblNom.TabIndex = 4;
@@ -94,7 +90,7 @@
             // 
             this.lblTel.AutoSize = true;
             this.lblTel.Font = new System.Drawing.Font("Tahoma", 12F);
-            this.lblTel.Location = new System.Drawing.Point(21, 372);
+            this.lblTel.Location = new System.Drawing.Point(22, 391);
             this.lblTel.Name = "lblTel";
             this.lblTel.Size = new System.Drawing.Size(94, 19);
             this.lblTel.TabIndex = 5;
@@ -104,7 +100,7 @@
             // 
             this.lblMail.AutoSize = true;
             this.lblMail.Font = new System.Drawing.Font("Tahoma", 12F);
-            this.lblMail.Location = new System.Drawing.Point(22, 402);
+            this.lblMail.Location = new System.Drawing.Point(23, 421);
             this.lblMail.Name = "lblMail";
             this.lblMail.Size = new System.Drawing.Size(48, 19);
             this.lblMail.TabIndex = 6;
@@ -113,7 +109,7 @@
             // txtTel
             // 
             this.txtTel.Font = new System.Drawing.Font("Microsoft Sans Serif", 11.25F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
-            this.txtTel.Location = new System.Drawing.Point(121, 371);
+            this.txtTel.Location = new System.Drawing.Point(122, 390);
             this.txtTel.Name = "txtTel";
             this.txtTel.Size = new System.Drawing.Size(113, 24);
             this.txtTel.TabIndex = 7;
@@ -121,7 +117,7 @@
             // txtNom
             // 
             this.txtNom.Font = new System.Drawing.Font("Microsoft Sans Serif", 11.25F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
-            this.txtNom.Location = new System.Drawing.Point(121, 341);
+            this.txtNom.Location = new System.Drawing.Point(122, 360);
             this.txtNom.Name = "txtNom";
             this.txtNom.Size = new System.Drawing.Size(113, 24);
             this.txtNom.TabIndex = 8;
@@ -129,16 +125,16 @@
             // txtMail
             // 
             this.txtMail.Font = new System.Drawing.Font("Microsoft Sans Serif", 11.25F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
-            this.txtMail.Location = new System.Drawing.Point(121, 400);
+            this.txtMail.Location = new System.Drawing.Point(122, 419);
             this.txtMail.Name = "txtMail";
-            this.txtMail.Size = new System.Drawing.Size(177, 24);
+            this.txtMail.Size = new System.Drawing.Size(261, 24);
             this.txtMail.TabIndex = 9;
             // 
             // lblPrenom
             // 
             this.lblPrenom.AutoSize = true;
             this.lblPrenom.Font = new System.Drawing.Font("Tahoma", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
-            this.lblPrenom.Location = new System.Drawing.Point(312, 342);
+            this.lblPrenom.Location = new System.Drawing.Point(313, 361);
             this.lblPrenom.Name = "lblPrenom";
             this.lblPrenom.Size = new System.Drawing.Size(75, 19);
             this.lblPrenom.TabIndex = 10;
@@ -147,7 +143,7 @@
             // txtPrenom
             // 
             this.txtPrenom.Font = new System.Drawing.Font("Microsoft Sans Serif", 11.25F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
-            this.txtPrenom.Location = new System.Drawing.Point(393, 340);
+            this.txtPrenom.Location = new System.Drawing.Point(394, 359);
             this.txtPrenom.Name = "txtPrenom";
             this.txtPrenom.Size = new System.Drawing.Size(113, 24);
             this.txtPrenom.TabIndex = 11;
@@ -156,7 +152,7 @@
             // 
             this.lblService.AutoSize = true;
             this.lblService.Font = new System.Drawing.Font("Tahoma", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
-            this.lblService.Location = new System.Drawing.Point(312, 372);
+            this.lblService.Location = new System.Drawing.Point(313, 391);
             this.lblService.Name = "lblService";
             this.lblService.Size = new System.Drawing.Size(70, 19);
             this.lblService.TabIndex = 12;
@@ -166,29 +162,69 @@
             // 
             this.cbbService.Font = new System.Drawing.Font("Microsoft Sans Serif", 11.25F);
             this.cbbService.FormattingEnabled = true;
-            this.cbbService.Items.AddRange(new object[] {
-            "Administratif",
-            "Mediation Culturelle",
-            "Pret"});
-            this.cbbService.Location = new System.Drawing.Point(393, 374);
+            this.cbbService.Location = new System.Drawing.Point(394, 393);
             this.cbbService.Name = "cbbService";
             this.cbbService.Size = new System.Drawing.Size(152, 26);
             this.cbbService.TabIndex = 13;
             // 
             // btnAjouterPersonnel
             // 
-            this.btnAjouterPersonnel.Location = new System.Drawing.Point(121, 439);
+            this.btnAjouterPersonnel.Location = new System.Drawing.Point(25, 327);
             this.btnAjouterPersonnel.Name = "btnAjouterPersonnel";
             this.btnAjouterPersonnel.Size = new System.Drawing.Size(182, 23);
             this.btnAjouterPersonnel.TabIndex = 14;
             this.btnAjouterPersonnel.Text = "Ajouter au personnel";
             this.btnAjouterPersonnel.UseVisualStyleBackColor = true;
+            this.btnAjouterPersonnel.Click += new System.EventHandler(this.btnAjouterPersonnel_Click);
+            // 
+            // dgvPersonnel
+            // 
+            this.dgvPersonnel.AllowUserToAddRows = false;
+            this.dgvPersonnel.AllowUserToDeleteRows = false;
+            dataGridViewCellStyle1.Alignment = System.Windows.Forms.DataGridViewContentAlignment.MiddleLeft;
+            dataGridViewCellStyle1.BackColor = System.Drawing.SystemColors.Control;
+            dataGridViewCellStyle1.Font = new System.Drawing.Font("Microsoft Sans Serif", 11.25F);
+            dataGridViewCellStyle1.ForeColor = System.Drawing.SystemColors.WindowText;
+            dataGridViewCellStyle1.SelectionBackColor = System.Drawing.SystemColors.Highlight;
+            dataGridViewCellStyle1.SelectionForeColor = System.Drawing.SystemColors.HighlightText;
+            dataGridViewCellStyle1.WrapMode = System.Windows.Forms.DataGridViewTriState.True;
+            this.dgvPersonnel.ColumnHeadersDefaultCellStyle = dataGridViewCellStyle1;
+            this.dgvPersonnel.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
+            this.dgvPersonnel.Location = new System.Drawing.Point(26, 12);
+            this.dgvPersonnel.Name = "dgvPersonnel";
+            this.dgvPersonnel.ReadOnly = true;
+            this.dgvPersonnel.RowHeadersWidthSizeMode = System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToAllHeaders;
+            this.dgvPersonnel.Size = new System.Drawing.Size(706, 276);
+            this.dgvPersonnel.TabIndex = 15;
+            // 
+            // btnEnregistrerPersonnel
+            // 
+            this.btnEnregistrerPersonnel.Location = new System.Drawing.Point(122, 449);
+            this.btnEnregistrerPersonnel.Name = "btnEnregistrerPersonnel";
+            this.btnEnregistrerPersonnel.Size = new System.Drawing.Size(182, 23);
+            this.btnEnregistrerPersonnel.TabIndex = 16;
+            this.btnEnregistrerPersonnel.Text = "Enregistrer au personnel";
+            this.btnEnregistrerPersonnel.UseVisualStyleBackColor = true;
+            this.btnEnregistrerPersonnel.Click += new System.EventHandler(this.btnEnregistrerPersonnel_Click);
+            // 
+            // btnAnnulerAjout
+            // 
+            this.btnAnnulerAjout.Location = new System.Drawing.Point(394, 449);
+            this.btnAnnulerAjout.Name = "btnAnnulerAjout";
+            this.btnAnnulerAjout.Size = new System.Drawing.Size(152, 23);
+            this.btnAnnulerAjout.TabIndex = 17;
+            this.btnAnnulerAjout.Text = "Annuler";
+            this.btnAnnulerAjout.UseVisualStyleBackColor = true;
+            this.btnAnnulerAjout.Click += new System.EventHandler(this.btnAnnulerAjout_Click);
             // 
             // frmListePersonnel
             // 
             this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
             this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
             this.ClientSize = new System.Drawing.Size(764, 506);
+            this.Controls.Add(this.btnAnnulerAjout);
+            this.Controls.Add(this.btnEnregistrerPersonnel);
+            this.Controls.Add(this.dgvPersonnel);
             this.Controls.Add(this.btnAjouterPersonnel);
             this.Controls.Add(this.cbbService);
             this.Controls.Add(this.lblService);
@@ -203,17 +239,15 @@
             this.Controls.Add(this.btnGererAbsence);
             this.Controls.Add(this.btnModifPersonnel);
             this.Controls.Add(this.btnSupPersonnel);
-            this.Controls.Add(this.lstListePersonnel);
             this.Name = "frmListePersonnel";
             this.Text = "Liste Personnel";
+            ((System.ComponentModel.ISupportInitialize)(this.dgvPersonnel)).EndInit();
             this.ResumeLayout(false);
             this.PerformLayout();
 
         }
 
         #endregion
-
-        private System.Windows.Forms.ListBox lstListePersonnel;
         private System.Windows.Forms.Button btnSupPersonnel;
         private System.Windows.Forms.Button btnModifPersonnel;
         private System.Windows.Forms.Button btnGererAbsence;
@@ -228,5 +262,8 @@
         private System.Windows.Forms.Label lblService;
         private System.Windows.Forms.ComboBox cbbService;
         private System.Windows.Forms.Button btnAjouterPersonnel;
+        private System.Windows.Forms.DataGridView dgvPersonnel;
+        private System.Windows.Forms.Button btnEnregistrerPersonnel;
+        private System.Windows.Forms.Button btnAnnulerAjout;
     }
 }
\ No newline at end of file
diff --git a/MediaTek86/vue/ListePersonnel.cs b/MediaTek86/vue/ListePersonnel.cs
index 470d1dc..75724f0 100644
--- a/MediaTek86/vue/ListePersonnel.cs
+++ b/MediaTek86/vue/ListePersonnel.cs
@@ -7,18 +7,138 @@ using System.Linq;
 using System.Text;
 using System.Threading.Tasks;
 using System.Windows.Forms;
+using MediaTek86.modele;
+using MediaTek86.controle;
 
 namespace MediaTek86.vue
 {
     public partial class frmListePersonnel : Form
     {
         /// <summary>
-        /// Initialisation des composants graphiques
-        /// Récupération du controleur
+        /// instance du controleur
         /// </summary>
-        public frmListePersonnel()
+        private Controle controle;
+
+        /// <summary>
+        /// Objet pour gérer la liste du personnel
+        /// </summary>
+        public BindingSource bdgPersonnel = new BindingSource();
+        /// <summary>
+        /// Objet pour gérer la liste des profils
+        /// </summary>
+        public BindingSource bdgService = new BindingSource();
+        public frmListePersonnel(Controle controle)
         {
             InitializeComponent();
+            this.controle = controle;
+            Init();
+        }
+
+        /// <summary>
+        /// Affiche ou non les zones de texte pour ajouter un personnel
+        /// </summary>
+        /// <param name="boolean"></param>
+        public void GererZoneTexte(Boolean boolean)
+        {
+            lblNom.Visible = boolean;
+            lblPrenom.Visible = boolean;
+            lblTel.Visible = boolean;
+            lblMail.Visible = boolean;
+            lblService.Visible = boolean;
+            txtNom.Visible = boolean;
+            txtPrenom.Visible = boolean;
+            txtTel.Visible = boolean;
+            txtMail.Visible = boolean;
+            cbbService.Visible = boolean;
+            btnEnregistrerPersonnel.Visible = boolean;
+            btnAnnulerAjout.Visible = boolean;
+        }
+
+        /// <summary>
+        /// Vide les zones de saisies
+        /// </summary>
+        public void ViderZoneTexte()
+        {
+            txtNom.Text = "";
+            txtPrenom.Text = "";
+            txtTel.Text = "";
+            txtMail.Text = "";
+
+        }
+
+        /// <summary>
+        /// Initialisation de la frame : remplissage des listes
+        /// </summary>
+        public void Init()
+        {
+            RemplirListePersonnel();
+            RemplirListeService();
+            GererZoneTexte(false);
+        }
+
+        /// <summary>
+        /// Affiche le personnel
+        /// </summary>
+        public void RemplirListePersonnel()
+        {
+            List<Personnel> lesPersonnels = controle.GetLesPersonnels();
+            bdgPersonnel.DataSource = lesPersonnels;
+            dgvPersonnel.DataSource = bdgPersonnel;
+            dgvPersonnel.Columns["idpersonnel"].Visible = false;
+            dgvPersonnel.Columns["idservice"].Visible = false;
+            dgvPersonnel.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.AllCells;
+        }
+
+        /// <summary>
+        /// Affiche les services
+        /// </summary>
+        public void RemplirListeService()
+        {
+            List<Service> lesServices = controle.GetLesServices();
+            bdgService.DataSource = lesServices;
+            cbbService.DataSource = bdgService;
+            if (cbbService.Items.Count > 0)
+            {
+                cbbService.SelectedIndex = 0;
+            }
+        }
+
+        private void btnAjouterPersonnel_Click(object sender, EventArgs e)
+        {
+            GererZoneTexte(true);
+        }
+
+        /// <summary>
+        /// Annule l'ajout d'un personnel
+        /// </summary>
+        /// <param name="sender"></param>
+        /// <param name="e"></param>
+        private void btnAnnulerAjout_Click(object sender, EventArgs e)
+        {
+            GererZoneTexte(false);
+            ViderZoneTexte();
+        }
+
+        /// <summary>
+        /// Enregistre et ajoute un personnel à la liste
+        /// </summary>
+        /// <param name="sender"></param>
+        /// <param name="e"></param>
+        private void btnEnregistrerPersonnel_Click(object sender, EventArgs e)
+        {
+            if (!txtNom.Text.Equals("") && !txtPrenom.Text.Equals("") && !txtTel.Text.Equals("") && !txtMail.Text.Equals("") && cbbService.SelectedIndex != -1)
+            {
+                Service service = (Service)bdgService.List[bdgService.Position];
+                int idpersonnel = 0;
+                Personnel personnel = new Personnel(idpersonnel, txtNom.Text, txtPrenom.Text, txtTel.Text, txtMail.Text, service.Idservice, service.Nom);
+                controle.AddDeveloppeur(personnel);
+                RemplirListePersonnel();
+                ViderZoneTexte();
+            }
+            else
+            {
+                MessageBox.Show("Tous les champs doivent être remplis.", "Information");
+            }
         }
     }
 }
diff --git a/MediaTek86/vue/SeConnecter.cs b/MediaTek86/vue/SeConnecter.cs
index 240f588..b29a273 100644
--- a/MediaTek86/vue/SeConnecter.cs
+++ b/MediaTek86/vue/SeConnecter.cs
@@ -22,6 +22,6 @@ namespace MediaTek86.vue
             InitializeComponent();
         }
 
-    
+
     }
 }
-- 
2.49.0.windows.1

