From 76a865323a77d3ecb27547cdc3c1839c82642b5d Mon Sep 17 00:00:00 2001
From: florent Richard <florent.r08@live.fr>
Date: Fri, 16 Apr 2021 17:24:52 +0200
Subject: [PATCH] =?UTF-8?q?Ajout=20de=20la=20fonctionnalit=C3=A9=20pour=20?=
 =?UTF-8?q?supprimer=20un=20personnel?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 MediaTek86/controle/Controle.cs           |  9 +++++++++
 MediaTek86/dal/AccesDonnees.cs            | 13 +++++++++++++
 MediaTek86/vue/ListePersonnel.Designer.cs |  1 +
 MediaTek86/vue/ListePersonnel.cs          | 22 ++++++++++++++++++++++
 4 files changed, 45 insertions(+)

diff --git a/MediaTek86/controle/Controle.cs b/MediaTek86/controle/Controle.cs
index 0660903..d335715 100644
--- a/MediaTek86/controle/Controle.cs
+++ b/MediaTek86/controle/Controle.cs
@@ -54,5 +54,14 @@ namespace MediaTek86.controle
         {
             AccesDonnees.AddPersonnel(personnel);
         }
+
+        /// <summary>
+        /// Demande de suppression d'un personnel
+        /// </summary>
+        /// <param name="personnel"></param>
+        public void DelPersonnel(Personnel personnel)
+        {
+            AccesDonnees.DelPersonnel(personnel);
+        }
     }
 }
diff --git a/MediaTek86/dal/AccesDonnees.cs b/MediaTek86/dal/AccesDonnees.cs
index 337c386..c51f968 100644
--- a/MediaTek86/dal/AccesDonnees.cs
+++ b/MediaTek86/dal/AccesDonnees.cs
@@ -74,6 +74,19 @@ namespace MediaTek86.dal
             conn.ReqUpdate(req, parameters);
         }
 
+        /// <summary>
+        /// Suppression d'un personnel
+        /// </summary>
+        /// <param name="personnel">objet developpeur à supprimer</param>
+        public static void DelPersonnel(Personnel personnel)
+        {
+            string req = "delete from personnel where idpersonnel = @idpersonnel;";
+            Dictionary<string, object> parameters = new Dictionary<string, object>();
+            parameters.Add("@idpersonnel", personnel.Idpersonnel);
+            ConnexionBDD conn = ConnexionBDD.GetInstance(connectionString);
+            conn.ReqUpdate(req, parameters);
+        }
+
     }
 
 }
diff --git a/MediaTek86/vue/ListePersonnel.Designer.cs b/MediaTek86/vue/ListePersonnel.Designer.cs
index 1d5ecd5..ceeca1a 100644
--- a/MediaTek86/vue/ListePersonnel.Designer.cs
+++ b/MediaTek86/vue/ListePersonnel.Designer.cs
@@ -57,6 +57,7 @@
             this.btnSupPersonnel.TabIndex = 1;
             this.btnSupPersonnel.Text = "Supprimer du personnel";
             this.btnSupPersonnel.UseVisualStyleBackColor = true;
+            this.btnSupPersonnel.Click += new System.EventHandler(this.btnSupPersonnel_Click);
             // 
             // btnModifPersonnel
             // 
diff --git a/MediaTek86/vue/ListePersonnel.cs b/MediaTek86/vue/ListePersonnel.cs
index 75724f0..ce80e22 100644
--- a/MediaTek86/vue/ListePersonnel.cs
+++ b/MediaTek86/vue/ListePersonnel.cs
@@ -140,5 +140,27 @@ namespace MediaTek86.vue
                 MessageBox.Show("Tous les champs doivent être remplis.", "Information");
             }
         }
+
+        /// <summary>
+        /// Supprime un personnel de la liste
+        /// </summary>
+        /// <param name="sender"></param>
+        /// <param name="e"></param>
+        private void btnSupPersonnel_Click(object sender, EventArgs e)
+        {
+            if (dgvPersonnel.SelectedRows.Count > 0)
+            {
+                Personnel personnel = (Personnel)bdgPersonnel.List[bdgPersonnel.Position];
+                if (MessageBox.Show("Voulez-vous vraiment supprimer " + personnel.Nom + " " + personnel.Prenom + " ?", "Confirmation de suppression", MessageBoxButtons.YesNo) == DialogResult.Yes)
+                {
+                    controle.DelPersonnel(personnel);
+                    RemplirListePersonnel();
+                }
+            }
+            else
+            {
+                MessageBox.Show("Une ligne doit être sélectionnée.", "Information");
+            }
+        }
     }
 }
-- 
2.49.0.windows.1

