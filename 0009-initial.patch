From 5c4b61b3b4edb2bc2c3b1447e6caa10c3b8dd873 Mon Sep 17 00:00:00 2001
From: florent Richard <florent.r08@live.fr>
Date: Thu, 22 Apr 2021 12:13:21 +0200
Subject: [PATCH] =?UTF-8?q?Correction=20de=20bugs=20sur=20la=20modificatio?=
 =?UTF-8?q?n=20d'un=20personnel=20et=20sur=20l'acc=C3=A9s=20=C3=A0=20la=20?=
 =?UTF-8?q?gestion=20des=20absences?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 MediaTek86/controle/Controle.cs         |  38 ++++++--
 MediaTek86/vue/GererAbsence.Designer.cs |   1 +
 MediaTek86/vue/GererAbsence.cs          |   4 +
 MediaTek86/vue/ListePersonnel.cs        |   6 +-
 MediaTek86/vue/ModificationPersonnel.cs | 115 +++++++++++++++++++++---
 5 files changed, 140 insertions(+), 24 deletions(-)

diff --git a/MediaTek86/controle/Controle.cs b/MediaTek86/controle/Controle.cs
index 628f5f6..faa731d 100644
--- a/MediaTek86/controle/Controle.cs
+++ b/MediaTek86/controle/Controle.cs
@@ -86,13 +86,15 @@ namespace MediaTek86.controle
         public void DemGererAbsence()
         {
             Personnel personnel = (Personnel)frmListePersonnel.bdgPersonnel.List[frmListePersonnel.bdgPersonnel.Position];
-            frmListePersonnel.Hide();
             frmGererAbsence = new frmGererAbsence(this);
             frmGererAbsence.RemplirListeAbsence(personnel);
             frmGererAbsence.SetNom(personnel.Nom);
             frmGererAbsence.SetPrenom(personnel.Prenom);
             frmGererAbsence.SetIdPersonnel(personnel.Idpersonnel);
+            Console.WriteLine("Nom :" + personnel.Nom);
+            Console.WriteLine("Prenom :" + personnel.Prenom);
             frmGererAbsence.ShowDialog();
+
         }
 
         /// <summary>
@@ -131,15 +133,35 @@ namespace MediaTek86.controle
             frmListePersonnel.Hide();
             frmModificationPersonnel = new frmModificationPersonnel(this);
             Personnel personnel = (Personnel)frmListePersonnel.bdgPersonnel.List[frmListePersonnel.bdgPersonnel.Position];
-            frmModificationPersonnel.idpersonnel = personnel.Idpersonnel;
-            frmModificationPersonnel.nom = personnel.Nom;
-            frmModificationPersonnel.prenom = personnel.Prenom;
-            frmModificationPersonnel.tel = personnel.Tel;
-            frmModificationPersonnel.mail = personnel.Mail;
-            frmModificationPersonnel.service = personnel.Service;
+            frmModificationPersonnel.SetIdPersonnel(personnel.Idpersonnel);
+            frmModificationPersonnel.SetNom(personnel.Nom);
+            frmModificationPersonnel.SetPrenom(personnel.Prenom);
+            frmModificationPersonnel.SetTel(personnel.Tel);
+            frmModificationPersonnel.SetMail(personnel.Mail);
+            frmModificationPersonnel.SetService(personnel.Service);
             // Ouvre la fenêtre frmModificationPersonnel
             frmModificationPersonnel.ShowDialog();
         }
+        
+        /// <summary>
+        /// Demande pour annule la modification d'un personnel 
+        /// </summary>
+        public void AnnulerUpdatePersonnel()
+        {
+            frmModificationPersonnel.Hide();
+            frmListePersonnel = new frmListePersonnel(this);
+            frmListePersonnel.ShowDialog();
+        }
+
+        /// <summary>
+        /// Demande pour retourner à la liste des personnels
+        /// </summary>
+        public void RetourListePerso()
+        {
+            frmGererAbsence.Hide();
+            frmListePersonnel = new frmListePersonnel(this);
+            frmListePersonnel.ShowDialog();
+        }
 
         /// <summary>
         /// Enregistre les modifications d'un personnel
@@ -151,7 +173,7 @@ namespace MediaTek86.controle
         public void EnrUpdatePersonnel(string nom, string prenom, string tel, string mail)
         {
             Service service = (Service)frmModificationPersonnel.bdgService.List[frmModificationPersonnel.bdgService.Position];
-            Personnel personnel = new Personnel(frmModificationPersonnel.idpersonnel, nom, prenom, tel, mail, service.Idservice, service.Nom);
+            Personnel personnel = new Personnel(frmModificationPersonnel.GetIdPersonnel(), nom, prenom, tel, mail, service.Idservice, service.Nom);
             AccesDonnees.UpdatePersonnel(personnel);
             frmModificationPersonnel.Hide();
             frmListePersonnel = new frmListePersonnel(this);
diff --git a/MediaTek86/vue/GererAbsence.Designer.cs b/MediaTek86/vue/GererAbsence.Designer.cs
index c131706..dd10a97 100644
--- a/MediaTek86/vue/GererAbsence.Designer.cs
+++ b/MediaTek86/vue/GererAbsence.Designer.cs
@@ -119,6 +119,7 @@
             this.btnRetourListePerso.TabIndex = 18;
             this.btnRetourListePerso.Text = "Retour à la liste du personnel";
             this.btnRetourListePerso.UseVisualStyleBackColor = true;
+            this.btnRetourListePerso.Click += new System.EventHandler(this.btnRetourListePerso_Click);
             // 
             // btnModifAbsence
             // 
diff --git a/MediaTek86/vue/GererAbsence.cs b/MediaTek86/vue/GererAbsence.cs
index e5c73c4..fa603a5 100644
--- a/MediaTek86/vue/GererAbsence.cs
+++ b/MediaTek86/vue/GererAbsence.cs
@@ -153,5 +153,9 @@ namespace MediaTek86.vue
             dgvAbsence.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.AllCells;
         }
 
+        private void btnRetourListePerso_Click(object sender, EventArgs e)
+        {
+            controle.RetourListePerso();
+        }
     }
 }
diff --git a/MediaTek86/vue/ListePersonnel.cs b/MediaTek86/vue/ListePersonnel.cs
index bfa65d9..a827e88 100644
--- a/MediaTek86/vue/ListePersonnel.cs
+++ b/MediaTek86/vue/ListePersonnel.cs
@@ -18,11 +18,6 @@ namespace MediaTek86.vue
         /// </summary>
         private Controle controle;
 
-        /// <summary>
-        /// instance de frmGererAbsence
-        /// </summary>
-        public frmGererAbsence frmGererAbsence;
-
         /// <summary>
         /// Objet pour gérer la liste du personnel
         /// </summary>
@@ -188,6 +183,7 @@ namespace MediaTek86.vue
         {
             if (dgvPersonnel.SelectedRows.Count > 0)
             {
+                this.Hide();
                 controle.DemGererAbsence();
             }
             else
diff --git a/MediaTek86/vue/ModificationPersonnel.cs b/MediaTek86/vue/ModificationPersonnel.cs
index 1c17bb2..31803c1 100644
--- a/MediaTek86/vue/ModificationPersonnel.cs
+++ b/MediaTek86/vue/ModificationPersonnel.cs
@@ -14,15 +14,110 @@ namespace MediaTek86.vue
     public partial class frmModificationPersonnel : Form
     {
         // Déclaration des propriétés
-        public int idpersonnel;
-        public string nom;
-        public string prenom;
-        public string tel;
-        public string mail;
-        public string service;
-
-        private frmListePersonnel frmListePersonnel;
+        private int idpersonnel;
+        private string nom;
+        private string prenom;
+        private string tel;
+        private string mail;
+        private string service;
 
+        /// <summary>
+        /// Permet de changer la valeur de idpersonnel
+        /// </summary>
+        /// <param name="idpersonnel"></param>
+        public void SetIdPersonnel(int idpersonnel)
+        {
+            this.idpersonnel = idpersonnel;
+        }
+        /// <summary>
+        /// Retourne idpersonnel
+        /// </summary>
+        /// <returns></returns>
+        public int GetIdPersonnel()
+        {
+            return idpersonnel;
+        }
+        /// <summary>
+        /// Permet de changer la valeur de nom
+        /// </summary>
+        /// <param name="nom"></param>
+        public void SetNom(string nom)
+        {
+            this.nom = nom;
+        }
+        /// <summary>
+        /// Retourne nom
+        /// </summary>
+        /// <returns></returns>
+        public string GetNom()
+        {
+            return nom;
+        }
+        /// <summary>
+        /// Permet de changer la valeur de prenom
+        /// </summary>
+        /// <param name="prenom"></param>
+        public void SetPrenom(string prenom)
+        {
+            this.prenom = prenom;
+        }
+        /// <summary>
+        /// Retourne prenom
+        /// </summary>
+        /// <returns></returns>
+        public string Getprenom()
+        {
+            return prenom;
+        }
+        /// <summary>
+        /// Permet de changer la valeur de tel
+        /// </summary>
+        /// <param name="tel"></param>
+        public void SetTel(string tel)
+        {
+            this.tel = tel;
+        }
+        /// <summary>
+        /// Retourne tel
+        /// </summary>
+        /// <returns></returns>
+        public string GetTel()
+        {
+            return tel;
+        }
+        /// <summary>
+        /// Permet de changer la valeur de mail
+        /// </summary>
+        /// <param name="mail"></param>
+        public void SetMail(string mail)
+        {
+            this.mail = mail;
+        }
+        /// <summary>
+        /// Retourne mail
+        /// </summary>
+        /// <returns></returns>
+        public string GetMail()
+        {
+            return mail;
+        }
+        /// <summary>
+        /// Permet de changer la valeur de service
+        /// </summary>
+        /// <param name="service"></param>
+        public void SetService(string service)
+        {
+            this.service = service;
+        }
+        /// <summary>
+        /// Retourne service
+        /// </summary>
+        /// <returns></returns>
+        public string GetService()
+        {
+            return service;
+        }
+        
         /// <summary>
         /// instance du controleur
         /// </summary>
@@ -85,9 +180,7 @@ namespace MediaTek86.vue
         /// <param name="e"></param>
         private void btnAnnulerModif_Click(object sender, EventArgs e)
         {
-            this.Hide();
-            frmListePersonnel = new frmListePersonnel(controle);
-            frmListePersonnel.ShowDialog();
+            controle.AnnulerUpdatePersonnel();
         }
 
         /// <summary>
-- 
2.49.0.windows.1

